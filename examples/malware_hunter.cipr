echo "--- Malware Signature Hunter ---";
let dir = ".";
let sig = "eval"; // Looking for dangerous 'eval' calls

let files = ls(dir);
echo "Scanning " + size(files) + " files in " + dir + "...";

for (let i = 0; i < size(files); i = i + 1) {
    let name = files[i];
    let content = read_file(name);
    
    // Simple check: does the file contain the signature?
    // We use extract() to find if the word exists
    // (extract returns empty string if not found)
    let found = extract(content, sig, "");
    
    // Note: extract logic returns empty if start marker not found.
    // Hack: splitting by signature. If size > 1, it exists.
    let parts = split(content, sig);
    if (size(parts) > 1) {
        echo "[!] SUSPICIOUS: " + name + " contains '" + sig + "'";
    }
}
